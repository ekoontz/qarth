<!DOCTYPE html>
<html><head><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>qarth.oauth documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html">Qarth 0.1.0-SNAPSHOT API documentation</a></h1></div><div class="sidebar" id="namespaces"><h3><span>Namespaces</span></h3><ul><li><a href="qarth.auth.html"><span>qarth.auth</span></a></li><li><a href="qarth.friend.html"><span>qarth.friend</span></a></li><li><a href="qarth.impl.facebook.html"><span>qarth.impl.facebook</span></a></li><li><a href="qarth.impl.github.html"><span>qarth.impl.github</span></a></li><li><a href="qarth.impl.google.html"><span>qarth.impl.google</span></a></li><li><a href="qarth.impl.scribe.html"><span>qarth.impl.scribe</span></a></li><li><a href="qarth.impl.yahoo.html"><span>qarth.impl.yahoo</span></a></li><li class="current"><a href="qarth.oauth.html"><span>qarth.oauth</span></a></li><li><a href="qarth.oauth.lib.html"><span>qarth.oauth.lib</span></a></li><li><a href="qarth.util.html"><span>qarth.util</span></a></li></ul></div><div class="sidebar" id="vars"><h3>Public Vars</h3><ul><li><a href="qarth.oauth.html#var-activate"><span>activate</span></a></li><li><a href="qarth.oauth.html#var-active%3F"><span>active?</span></a></li><li><a href="qarth.oauth.html#var-build"><span>build</span></a></li><li><a href="qarth.oauth.html#var-extract-code"><span>extract-code</span></a></li><li><a href="qarth.oauth.html#var-id"><span>id</span></a></li><li><a href="qarth.oauth.html#var-new-record"><span>new-record</span></a></li><li><a href="qarth.oauth.html#var-requestor"><span>requestor</span></a></li><li><a href="qarth.oauth.html#var-resp-reader"><span>resp-reader</span></a></li></ul></div><div class="namespace-docs" id="content"><h2>qarth.oauth documentation</h2><pre class="doc">Base fns for OAuth and OAuth-style interactive auth services.
You can also define your own auth implementations--see the docs.</pre><div class="public" id="var-activate"><h3>activate</h3><div class="usage"></div><pre class="doc">Multimethod. Usage:
(activate service record auth-code)
Takes a new auth record and a auth-code, and creates an active auth record.
If activation fails, can return nil or optionally
throw an Exception of some kind.</pre><div class="src-link"><a href="http://github.com/eightnotrump/qarth/blob/master/src/qarth/oauth.clj#L89">Source</a></div></div><div class="public" id="var-active%3F"><h3>active?</h3><div class="usage"></div><pre class="doc">Multimethod. Usage:
(active? service record)
True if a record is active (authenticated and usable), false otherwise.</pre><div class="src-link"><a href="http://github.com/eightnotrump/qarth/blob/master/src/qarth/oauth.clj#L106">Source</a></div></div><div class="public" id="var-build"><h3>build</h3><div class="usage"></div><pre class="doc">Multimethod. Usage:
(build {:type type :api-key my-key :api-secret my-secret ...})

Create an auth service from a hash map specification.

Mandatory fields:
:type -- the type of the service; multimethods dispatch on this

Usually required for OAuth:
:api-key -- your API key. the [type, api-key] pair uniquely identifies a service
:api-secret -- your API secret

Implementations may accept other fields also, such as the following:
:callback -- a callback URL for interactive browser logins

Auth services contain secret information, like api secret keys.
Be careful if about writing or serializing them.</pre><div class="src-link"><a href="http://github.com/eightnotrump/qarth/blob/master/src/qarth/oauth.clj#L14">Source</a></div></div><div class="public" id="var-extract-code"><h3>extract-code</h3><div class="usage"></div><pre class="doc">Multimethod. Usage:
(extract-code service record ring-request)

Return an auth code from the given Ring-formatted request.
If the request was invalid (perhaps due to a CSRF attack),
it should return nil.</pre><div class="src-link"><a href="http://github.com/eightnotrump/qarth/blob/master/src/qarth/oauth.clj#L72">Source</a></div></div><div class="public" id="var-id"><h3>id</h3><div class="usage"></div><pre class="doc">Multimethod. Optional. Usage:
(id requestor)

Gets a user ID from the requestor. The ID is guaranteed to be unique
and unchanging per service.</pre><div class="src-link"><a href="http://github.com/eightnotrump/qarth/blob/master/src/qarth/oauth.clj#L183">Source</a></div></div><div class="public" id="var-new-record"><h3>new-record</h3><div class="usage"></div><pre class="doc">Multimethod. Usage:
(new-record service)
(new-record multi-service key)

Returns an inactive OAuth record. An OAuth record keeps tracks of
state tokens, request tokens, auth codes, access tokens, CSRF, &amp;c.

Returns a map with:
:type -- required, the type of the record
:url -- optional, a callback URL for interactive auth
other various implementation-specific keys</pre><div class="src-link"><a href="http://github.com/eightnotrump/qarth/blob/master/src/qarth/oauth.clj#L48">Source</a></div></div><div class="public" id="var-requestor"><h3>requestor</h3><div class="usage"></div><pre class="doc">Multimethod. Usage:
(let [r (requestor service record)]
  (r opts))

Returns a fn that can be used to make requests to the auth service.
The requestor works similarly to the Clojure library clj-http.
If the record is inactive (perhaps it expired or was never activated),
throws a Slingshot exception {::qarth.auth/unauthorized true}.

Mandatory opt:
:url -- the request URL

Supported opts:
:method -- :GET, :PUT, :POST, :DELETE, default :GET
:body -- the HTTP body for PUT or POST. Overrides form-params.
Can be anything usable by clojure.java.io (e.g. a String or byte array).
:form-params -- the form parameters
:query-params -- the query parameters
:headers -- a string-&gt;string map
:follow-redirects -- true or false, default true

Returns a Ring-Style response map containing at least:
:status -- the status code
:headers -- the http headers
:body -- an InputStream (be sure to read and/or close it when you're done!)

If an exceptional status code happens, throws an Exception instead.
Other implementations might support more opts and return more stuff.

A default implementation is provided for implementors. It adds the param
:access_token to the form params if it's a POST, and the query if it's a GET.</pre><div class="src-link"><a href="http://github.com/eightnotrump/qarth/blob/master/src/qarth/oauth.clj#L117">Source</a></div></div><div class="public" id="var-resp-reader"><h3>resp-reader</h3><div class="usage"><code>(resp-reader req)</code></div><pre class="doc">Get a reader from a response map. Make sure to close and/or fully read it.
</pre><div class="src-link"><a href="http://github.com/eightnotrump/qarth/blob/master/src/qarth/oauth.clj#L167">Source</a></div></div></div></body></html>